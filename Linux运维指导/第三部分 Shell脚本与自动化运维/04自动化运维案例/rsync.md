

# ä½¿ç”¨rsyncå®ç°å¢é‡å¤‡ä»½çš„è¯¦ç»†æ­¥éª¤

## ğŸŒŸ ä»€ä¹ˆæ˜¯rsyncï¼Ÿ

`rsync` æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ–‡ä»¶åŒæ­¥å·¥å…·ï¼Œç‰¹åˆ«é€‚ç”¨äºå¢é‡å¤‡ä»½ã€‚å®ƒé€šè¿‡æ¯”è¾ƒæºæ–‡ä»¶å’Œç›®æ ‡æ–‡ä»¶çš„å·®å¼‚ï¼Œä»…ä¼ è¾“å˜åŒ–çš„éƒ¨åˆ†ï¼Œä»è€ŒèŠ‚çœæ—¶é—´å’Œå­˜å‚¨ç©ºé—´ã€‚

## ğŸ“ å¢é‡å¤‡ä»½çš„ä¼˜åŠ¿

1. **èŠ‚çœæ—¶é—´**ï¼šåªä¼ è¾“å˜åŒ–çš„æ•°æ®ã€‚
2. **èŠ‚çœå­˜å‚¨**ï¼šé¿å…é‡å¤å¤‡ä»½ç›¸åŒçš„æ•°æ®ã€‚
3. **é«˜æ•ˆå¯é **ï¼šå³ä½¿ç½‘ç»œä¸­æ–­ï¼Œä¹Ÿèƒ½ä»æ–­ç‚¹ç»­ä¼ ã€‚

---

## ğŸ“˜ æ­¥éª¤ä¸€ï¼šå®‰è£…rsync

å¤§å¤šæ•°Linuxå‘è¡Œç‰ˆé»˜è®¤å®‰è£…äº†rsyncï¼Œå¦‚æœæ²¡æœ‰å®‰è£…ï¼Œå¯ä»¥ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…ï¼š

**Debian/Ubuntuï¼š**

```bash
sudo apt-get install rsync
```

**Fedoraï¼š**

```bash
sudo dnf install rsync
```

**CentOS/RHELï¼š**

```bash
sudo yum install rsync
```

---

## ğŸ“˜ æ­¥éª¤äºŒï¼šé…ç½®æºå’Œç›®æ ‡ç›®å½•

å‡è®¾ä½ è¦å¤‡ä»½çš„ç›®å½•æ˜¯ `/home/user/project`ï¼Œå¤‡ä»½ç›®æ ‡ç›®å½•æ˜¯ `/home/user/backup`ã€‚

ç¡®ä¿ç›®æ ‡ç›®å½•å­˜åœ¨ï¼š

```bash
mkdir -p /home/user/backup
```

---

## ğŸ“˜ æ­¥éª¤ä¸‰ï¼šç¼–å†™rsyncå‘½ä»¤

åŸºæœ¬çš„rsyncå‘½ä»¤å¦‚ä¸‹ï¼š

```bash
rsync -avz /home/user/project/ /home/user/backup/
```

**å‚æ•°è§£é‡Šï¼š**

- `-a`ï¼šå½’æ¡£æ¨¡å¼ï¼Œä¿æŒæ–‡ä»¶å±æ€§ã€‚
- `-v`ï¼šè¯¦ç»†æ¨¡å¼ï¼Œæ˜¾ç¤ºå¤‡ä»½è¿‡ç¨‹ã€‚
- `-z`ï¼šå‹ç¼©ä¼ è¾“çš„æ•°æ®ã€‚

**æ³¨æ„ï¼š** æºç›®å½•æœ«å°¾çš„æ–œæ  `/home/user/project/` å¾ˆé‡è¦ï¼Œå®ƒè¡¨ç¤ºå¤‡ä»½ç›®å½•ä¸­çš„æ‰€æœ‰å†…å®¹ï¼Œè€Œä¸æ˜¯ç›®å½•æœ¬èº«ã€‚

---

## ğŸ“˜ æ­¥éª¤å››ï¼šæ‰§è¡Œå…¨é‡å¤‡ä»½

ç¬¬ä¸€æ¬¡è¿è¡Œrsyncå‘½ä»¤ä¼šæ‰§è¡Œå…¨é‡å¤‡ä»½ï¼Œä¼ è¾“æ‰€æœ‰æ–‡ä»¶ã€‚

```bash
rsync -avz /home/user/project/ /home/user/backup/
```

**ç¤ºä¾‹è¾“å‡ºï¼š**

```
sending incremental file list
file1.txt
file2.txt
subdir/
subdir/file3.txt
total: 3 files transferred
```

---

## ğŸ“˜ æ­¥éª¤äº”ï¼šä¿®æ”¹æ–‡ä»¶å¹¶æ‰§è¡Œå¢é‡å¤‡ä»½

ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š

```bash
echo "æ–°å¢å†…å®¹" >> /home/user/project/file1.txt
```

å†æ¬¡è¿è¡Œrsyncå‘½ä»¤ï¼š

```bash
rsync -avz /home/user/project/ /home/user/backup/
```

**ç¤ºä¾‹è¾“å‡ºï¼š**

```
sending incremental file list
file1.txt
total: 1 file transferred
```

è¿™æ¬¡åªä¼ è¾“äº†ä¿®æ”¹è¿‡çš„ `file1.txt`ã€‚

---

## ğŸ“˜ æ­¥éª¤å…­ï¼šè‡ªåŠ¨åŒ–å¢é‡å¤‡ä»½

ä¸ºäº†æ¯å¤©è‡ªåŠ¨æ‰§è¡Œå¤‡ä»½ï¼Œå¯ä»¥å°†rsyncå‘½ä»¤å†™å…¥è„šæœ¬ï¼Œå¹¶ä½¿ç”¨ `cron` å®šæ—¶ä»»åŠ¡ã€‚

**åˆ›å»ºè„šæœ¬ï¼š**

```bash
#!/bin/bash
rsync -avz /home/user/project/ /home/user/backup/
```

ä¿å­˜ä¸º `incremental_backup.sh`ï¼Œèµ‹äºˆæ‰§è¡Œæƒé™ï¼š

```bash
chmod +x incremental_backup.sh
```

**è®¾ç½®cronä»»åŠ¡ï¼š**

```bash
crontab -e
```

æ·»åŠ ä»¥ä¸‹è¡Œï¼š

```bash
0 0 * * * /home/user/incremental_backup.sh
```

è¿™æ ·ï¼Œæ¯å¤©åˆå¤œ0ç‚¹è‡ªåŠ¨æ‰§è¡Œå¢é‡å¤‡ä»½ã€‚

---

## ğŸ“˜ å¢é‡å¤‡ä»½çš„å…¶ä»–æŠ€å·§

1. **æ’é™¤ç‰¹å®šæ–‡ä»¶æˆ–ç›®å½•**

å¦‚æœä½ æƒ³æ’é™¤æŸäº›æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¯ä»¥ä½¿ç”¨ `--exclude` å‚æ•°ã€‚

```bash
rsync -avz --exclude='*.log' /home/user/project/ /home/user/backup/
```

2. **ä¿æŒæ–‡ä»¶æƒé™å’Œç¬¦å·é“¾æ¥**

ä½¿ç”¨ `-a` å‚æ•°å¯ä»¥ä¿æŒæ–‡ä»¶çš„æƒé™ã€æ—¶é—´æˆ³å’Œç¬¦å·é“¾æ¥ã€‚

3. **è¿œç¨‹å¤‡ä»½**

`rsync` è¿˜æ”¯æŒé€šè¿‡ SSH è¿›è¡Œè¿œç¨‹å¤‡ä»½ã€‚

```bash
rsync -avz /home/user/project/ user@remote-server:/home/backup/
```

---

## ğŸ“˜ æ€»ç»“

é€šè¿‡ `rsync` å®ç°å¢é‡å¤‡ä»½ï¼Œå¯ä»¥é«˜æ•ˆåœ°ä¿æŠ¤ä½ çš„æ•°æ®ã€‚å®ƒä¸ä»…èŠ‚çœæ—¶é—´å’Œå­˜å‚¨ç©ºé—´ï¼Œè¿˜æ”¯æŒå¤šç§çµæ´»çš„é…ç½®ï¼Œæ»¡è¶³ä¸åŒçš„å¤‡ä»½éœ€æ±‚ã€‚ç°åœ¨ï¼Œä½ å¯ä»¥æ”¾å¿ƒåœ°è‡ªåŠ¨åŒ–ä½ çš„æ•°æ®å¤‡ä»½ä»»åŠ¡ï¼Œè®© `rsync` ä¸ºä½ ä¿é©¾æŠ¤èˆªï¼ğŸš€




---

### ä½¿ç”¨rsyncå‘½ä»¤è¿›è¡Œå¢é‡å¤‡ä»½çš„è¯¦ç»†æ­¥éª¤

**ç›®æ ‡**ï¼šé€šè¿‡ä½¿ç”¨rsyncå‘½ä»¤ï¼Œå®ç°æ–‡ä»¶æˆ–ç›®å½•çš„å¢é‡å¤‡ä»½ï¼Œç¡®ä¿åªä¼ è¾“å˜åŒ–çš„æ•°æ®ï¼ŒèŠ‚çœæ—¶é—´å’Œå­˜å‚¨ç©ºé—´ã€‚

**æ­¥éª¤**ï¼š

1. **å®‰è£…rsync**

   ç¡®ä¿ç³»ç»Ÿå·²ç»å®‰è£…äº†rsyncã€‚å¤§å¤šæ•°Linuxå‘è¡Œç‰ˆé»˜è®¤å®‰è£…äº†rsyncï¼Œå¦‚æœæ²¡æœ‰å®‰è£…ï¼Œå¯ä»¥ä½¿ç”¨åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…ã€‚

   - **Debian/Ubuntu**ï¼š

     ```bash
     sudo apt-get install rsync
     ```

   - **Fedora**ï¼š

     ```bash
     sudo dnf install rsync
     ```

   - **CentOS/RHEL**ï¼š

     ```bash
     sudo yum install rsync
     ```

2. **ç¡®å®šè¦å¤‡ä»½çš„æ–‡ä»¶æˆ–ç›®å½•**

   å†³å®šè¦å¤‡ä»½çš„æºç›®å½•ï¼ˆ`$SOURCE`ï¼‰å’Œå¤‡ä»½çš„ç›®æ ‡ç›®å½•ï¼ˆ`$DEST`ï¼‰ã€‚

   ä¾‹å¦‚ï¼š

   - æºç›®å½•ï¼š`/home/user/project/`
   - å¤‡ä»½ç›®æ ‡ç›®å½•ï¼š`/home/user/backup/incre_backup/`

3. **åˆ›å»ºç›®æ ‡å¤‡ä»½ç›®å½•**

   ç¡®ä¿ç›®æ ‡å¤‡ä»½ç›®å½•å­˜åœ¨ã€‚

   ```bash
   mkdir -p /home/user/backup/incre_backup/
   ```

4. **ç¼–å†™rsyncå‘½ä»¤**

   ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå¢é‡å¤‡ä»½ï¼š

   ```bash
   rsync --progress --archive --compress --delete "$SOURCE/" "$DEST/incre_backup/"
   ```

   **å‚æ•°è§£é‡Š**ï¼š

   - `--progress`ï¼šæ˜¾ç¤ºä¼ è¾“è¿›åº¦ï¼Œè®©ç”¨æˆ·äº†è§£å¤‡ä»½çš„å®æ—¶æƒ…å†µã€‚
   - `--archive`ï¼šå½’æ¡£æ¨¡å¼ï¼Œä¿æŒæ–‡ä»¶çš„å±æ€§ï¼ŒåŒ…æ‹¬æƒé™ã€æ—¶é—´æˆ³ã€æ‰€æœ‰è€…ã€ç»„ç­‰ã€‚
   - `--compress`ï¼šå‹ç¼©ä¼ è¾“çš„æ•°æ®ï¼Œå‡å°‘ç½‘ç»œå¸¦å®½çš„ä½¿ç”¨ã€‚
   - `--delete`ï¼šåˆ é™¤ç›®æ ‡ç›®å½•ä¸­æºç›®å½•ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œä¿æŒç›®æ ‡ç›®å½•ä¸æºç›®å½•ä¸€è‡´ã€‚
   - `"$SOURCE/"`ï¼šæºç›®å½•ï¼Œæ³¨æ„æœ«å°¾çš„æ–œæ è¡¨ç¤ºåŒ…å«ç›®å½•ä¸­çš„æ‰€æœ‰å†…å®¹ã€‚
   - `"$DEST/incre_backup/"`ï¼šç›®æ ‡å¤‡ä»½ç›®å½•ï¼Œè¡¨ç¤ºå¤‡ä»½æ–‡ä»¶å°†è¢«å¤åˆ¶åˆ°è¿™ä¸ªå­ç›®å½•ä¸­ã€‚

5. **æ‰§è¡Œå…¨é‡å¤‡ä»½**

   ç¬¬ä¸€æ¬¡è¿è¡Œrsyncå‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œå…¨é‡å¤‡ä»½ï¼Œä¼ è¾“æ‰€æœ‰æ–‡ä»¶ã€‚

   ```bash
   rsync --progress --archive --compress --delete /home/user/project/ /home/user/backup/incre_backup/
   ```

   **ç¤ºä¾‹è¾“å‡º**ï¼š

   ```
   sending incremental file list
   file1.txt
   file2.txt
   subdir/
   subdir/file3.txt
   total: 3 files transferred
   ```

6. **ä¿®æ”¹æ–‡ä»¶å¹¶æ‰§è¡Œå¢é‡å¤‡ä»½**

   ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š

   ```bash
   echo "æ–°å¢å†…å®¹" >> /home/user/project/file1.txt
   ```

   å†æ¬¡è¿è¡Œrsyncå‘½ä»¤ï¼š

   ```bash
   rsync --progress --archive --compress --delete /home/user/project/ /home/user/backup/incre_backup/
   ```

   **ç¤ºä¾‹è¾“å‡º**ï¼š

   ```
   sending incremental file list
   file1.txt
   total: 1 file transferred
   ```

   è¿™æ¬¡åªä¼ è¾“äº†ä¿®æ”¹è¿‡çš„ `file1.txt`ã€‚

7. **è‡ªåŠ¨åŒ–å¢é‡å¤‡ä»½**

   ä¸ºäº†æ¯å¤©è‡ªåŠ¨æ‰§è¡Œå¤‡ä»½ï¼Œå¯ä»¥å°†rsyncå‘½ä»¤å†™å…¥è„šæœ¬ï¼Œå¹¶ä½¿ç”¨ `cron` å®šæ—¶ä»»åŠ¡ã€‚

   **åˆ›å»ºè„šæœ¬**ï¼š

   ```bash
   #!/bin/bash
   rsync --progress --archive --compress --delete /home/user/project/ /home/user/backup/incre_backup/
   ```

   ä¿å­˜ä¸º `incremental_backup.sh`ï¼Œèµ‹äºˆæ‰§è¡Œæƒé™ï¼š

   ```bash
   chmod +x incremental_backup.sh
   ```

   **è®¾ç½®cronä»»åŠ¡**ï¼š

   ```bash
   crontab -e
   ```

   æ·»åŠ ä»¥ä¸‹è¡Œï¼š

   ```bash
   0 0 * * * /home/user/incremental_backup.sh
   ```

   è¿™æ ·ï¼Œæ¯å¤©åˆå¤œ0ç‚¹è‡ªåŠ¨æ‰§è¡Œå¢é‡å¤‡ä»½ã€‚

8. **éªŒè¯å¤‡ä»½**

   å®šæœŸéªŒè¯å¤‡ä»½æ–‡ä»¶æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿å¤‡ä»½çš„å¯é æ€§å’Œå®Œæ•´æ€§ã€‚

   ```bash
   ls -l /home/user/backup/incre_backup/
   ```

9. **æ¢å¤å¤‡ä»½**

   å½“éœ€è¦æ¢å¤å¤‡ä»½æ—¶ï¼Œå¯ä»¥ä½¿ç”¨rsyncå°†å¤‡ä»½æ–‡ä»¶å¤åˆ¶å›åŸç›®å½•ã€‚

   ```bash
   rsync --progress --archive --compress /home/user/backup/incre_backup/ /home/user/project/
   ```

10. **æ³¨æ„äº‹é¡¹**

    - **æ•°æ®å®‰å…¨æ€§**ï¼šåœ¨ä½¿ç”¨`--delete`é€‰é¡¹æ—¶ï¼Œç¡®ä¿ç›®æ ‡ç›®å½•ä»…ç”¨äºå¤‡ä»½ï¼Œé¿å…è¯¯åˆ é‡è¦æ•°æ®ã€‚
    - **æµ‹è¯•**ï¼šåœ¨å®é™…ä½¿ç”¨å‰ï¼Œå»ºè®®åœ¨ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒä¸­è¿è¡Œrsyncå‘½ä»¤ï¼Œç¡®ä¿å…¶è¡Œä¸ºç¬¦åˆé¢„æœŸã€‚
    - **æ—¥å¿—è®°å½•**ï¼šå»ºè®®å°†rsyncå‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ°æ—¥å¿—æ–‡ä»¶ï¼Œä»¥ä¾¿åç»­æŸ¥çœ‹å’Œåˆ†æã€‚

11. **æ€»ç»“**

    é€šè¿‡rsyncå‘½ä»¤å®ç°çš„å¢é‡å¤‡ä»½ï¼Œèƒ½å¤Ÿé«˜æ•ˆåœ°ä¿æŠ¤æ•°æ®ï¼ŒèŠ‚çœæ—¶é—´å’Œå­˜å‚¨ç©ºé—´ã€‚åˆç†é…ç½®rsyncå‚æ•°ï¼Œå¯ä»¥æ»¡è¶³ä¸åŒçš„å¤‡ä»½éœ€æ±‚ï¼Œç¡®ä¿æ•°æ®çš„å®‰å…¨æ€§å’Œä¸€è‡´æ€§ã€‚